import{a as e,j as t}from"./index-C6dH91l4.js";import{r as s}from"./react-vendor-CrIkLlfu.js";import{d as a}from"./dayjs.min-BQQTCDPZ.js";import"./index-CUJUhf6U.js";import{B as r,I as l,S as i}from"./XiuxianUserSelector-BzkY7rk4.js";import{X as n}from"./XiuxianStatCard--fj3vPKu.js";import{X as o,a as c}from"./XiuxianPageTitle-B82fm0Nk.js";import{I as d,X as x,T as m}from"./XiuxianTableContainer-CXNKApVm.js";import{X as p}from"./XiuxianRefreshButton-CE9v1lfQ.js";import{X as u}from"./XiuxianEmptyState-BuRcUFy5.js";import{X as h}from"./XiuxianTableWithPagination-CsrFNxpj.js";import{F as j}from"./index-BFB2RYJM.js";import{R as g}from"./PlusOutlined-CosCjbxi.js";import{R as f,P as v}from"./index-6LVoZ_10.js";import{R as b}from"./ExclamationCircleOutlined-BBIYG0d-.js";import{R as y}from"./CheckCircleOutlined-BzSe_H53.js";import{R as N}from"./DeleteOutlined-xg6BmD0t.js";import{R as w}from"./EyeOutlined-49ivN6Pg.js";import{M as S}from"./index-DIK-2Ntt.js";import{R as k,C}from"./row-Dp6sn5R_.js";import{S as I}from"./Table-DiH3_X6U.js";import{s as T}from"./index-Dvcvf_wl.js";import{T as O}from"./index-ScSzRHsS.js";import{R as z}from"./UserOutlined-DjUwOZiz.js";import{R as E}from"./ClockCircleOutlined-BbNVhGmr.js";import"./reactNode-Cb2BqGKz.js";import"./extendsObject-C0ylGr8P.js";import"./index-CXi5mn11.js";import"./context-BssuM186.js";import"./index-D-Ps9Wui.js";import"./index-Bp4Q_HJ_.js";var P={};Object.defineProperty(P,"__esModule",{value:!0});var R=P.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M464 512a48 48 0 1096 0 48 48 0 10-96 0zm200 0a48 48 0 1096 0 48 48 0 10-96 0zm-400 0a48 48 0 1096 0 48 48 0 10-96 0zm661.2-173.6c-22.6-53.7-55-101.9-96.3-143.3a444.35 444.35 0 00-143.3-96.3C630.6 75.7 572.2 64 512 64h-2c-60.6.3-119.3 12.3-174.5 35.9a445.35 445.35 0 00-142 96.5c-40.9 41.3-73 89.3-95.2 142.8-23 55.4-34.6 114.3-34.3 174.9A449.4 449.4 0 00112 714v152a46 46 0 0046 46h152.1A449.4 449.4 0 00510 960h2.1c59.9 0 118-11.6 172.7-34.3a444.48 444.48 0 00142.8-95.2c41.3-40.9 73.8-88.7 96.5-142 23.6-55.2 35.6-113.9 35.9-174.5.3-60.9-11.5-120-34.8-175.6zm-151.1 438C704 845.8 611 884 512 884h-1.7c-60.3-.3-120.2-15.3-173.1-43.5l-8.4-4.5H188V695.2l-4.5-8.4C155.3 633.9 140.3 574 140 513.7c-.4-99.7 37.7-193.3 107.6-263.8 69.8-70.5 163.1-109.5 262.8-109.9h1.7c50 0 98.5 9.7 144.2 28.9 44.6 18.7 84.6 45.6 119 80 34.3 34.3 61.3 74.4 80 119 19.4 46.2 29.1 95.2 28.9 145.8-.6 99.6-39.7 192.9-110.1 262.7z"}}]},name:"message",theme:"outlined"};function X(){return X=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},X.apply(this,arguments)}const D=(e,t)=>s.createElement(d,X({},e,{ref:t,icon:R})),L=s.forwardRef(D);var M={};Object.defineProperty(M,"__esModule",{value:!0});var q=M.default={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M931.4 498.9L94.9 79.5c-3.4-1.7-7.3-2.1-11-1.2a15.99 15.99 0 00-11.7 19.3l86.2 352.2c1.3 5.3 5.2 9.6 10.4 11.3l147.7 50.7-147.6 50.7c-5.2 1.8-9.1 6-10.3 11.3L72.2 926.5c-.9 3.7-.5 7.6 1.2 10.9 3.9 7.9 13.5 11.1 21.5 7.2l836.5-417c3.1-1.5 5.6-4.1 7.2-7.1 3.9-8 .7-17.6-7.2-21.6zM170.8 826.3l50.3-205.6 295.2-101.3c2.3-.8 4.2-2.6 5-5 1.4-4.2-.8-8.7-5-10.2L221.1 403 171 198.2l628 314.9-628.2 313.2z"}}]},name:"send",theme:"outlined"};function B(){return B=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},B.apply(this,arguments)}const F=(e,t)=>s.createElement(d,B({},e,{ref:t,icon:q})),$=s.forwardRef(F),{TextArea:A}=l,{Option:Y}=i,_=()=>{const[d,P]=s.useState(null),[R,X]=s.useState(null),[D,M]=s.useState(!1),[q,B]=s.useState(!1),[F]=j.useForm(),[_,G]=s.useState(""),[H,K]=s.useState({current:1,pageSize:10,total:0}),U=async()=>{try{const s=await(t={global:!0},e({url:"/message-stats",method:"GET",params:t}));X(s.data)}catch(s){T.error("Ëé∑ÂèñÁªüËÆ°‰ø°ÊÅØÂ§±Ë¥•")}var t},V=async(t,s=1,a=10)=>{if(t){M(!0);try{const l=await(r={userId:t,page:s,pageSize:a},e({url:"/messages",method:"GET",params:r}));P(l.data),K({current:l.data.page,pageSize:l.data.pageSize,total:l.data.total})}catch(l){T.error("Ëé∑ÂèñÊ∂àÊÅØÂàóË°®Â§±Ë¥•")}finally{M(!1)}var r}},J=async(t,s)=>{try{await(a={userId:t,messageId:s},e({url:"/messages",method:"DELETE",data:a})),T.success("Âà†Èô§ÊàêÂäü"),V(t,H.current,H.pageSize)}catch(r){T.error("Âà†Èô§Â§±Ë¥•")}var a},Q=[{title:t.jsxs("div",{className:"flex items-center gap-2 text-purple-400 font-bold",children:[t.jsx(L,{className:"text-lg"}),t.jsx("span",{children:"Ê∂àÊÅØÊ†áÈ¢ò"})]}),dataIndex:"title",key:"title",width:200,ellipsis:!0,render:e=>t.jsx("span",{className:"text-white font-medium",children:e})},{title:t.jsx("div",{className:"flex items-center gap-2 text-blue-400 font-bold",children:t.jsx("span",{children:"Ê∂àÊÅØÂÜÖÂÆπ"})}),dataIndex:"content",key:"content",width:300,ellipsis:!0,render:e=>t.jsx(m,{title:e,children:t.jsx("span",{className:"text-slate-300",children:e.length>50?`${e.substring(0,50)}...`:e})})},{title:t.jsx("div",{className:"flex items-center gap-2 text-orange-400 font-bold",children:t.jsx("span",{children:"Ê∂àÊÅØÁ±ªÂûã"})}),dataIndex:"type",key:"type",width:120,render:e=>{const s={system:{color:"blue",text:"Á≥ªÁªüÊ∂àÊÅØ"},announcement:{color:"red",text:"ÂÖ¨Âëä"},reward:{color:"green",text:"Â•ñÂä±ÈÄöÁü•"},activity:{color:"orange",text:"Ê¥ªÂä®ÈÄöÁü•"},personal:{color:"purple",text:"‰∏™‰∫∫Ê∂àÊÅØ"}}[e]||{color:"default",text:e};return t.jsx(O,{color:s.color,children:s.text})}},{title:t.jsxs("div",{className:"flex items-center gap-2 text-yellow-400 font-bold",children:[t.jsx(b,{className:"text-lg"}),t.jsx("span",{children:"‰ºòÂÖàÁ∫ß"})]}),dataIndex:"priority",key:"priority",width:100,render:e=>{const s={1:{color:"default",text:"‰Ωé"},2:{color:"blue",text:"ÊôÆÈÄö"},3:{color:"orange",text:"È´ò"},4:{color:"red",text:"Á¥ßÊÄ•"}}[e]||{color:"default",text:"ÊôÆÈÄö"};return t.jsx(O,{color:s.color,children:s.text})}},{title:t.jsxs("div",{className:"flex items-center gap-2 text-green-400 font-bold",children:[t.jsx(y,{className:"text-lg"}),t.jsx("span",{children:"Áä∂ÊÄÅ"})]}),dataIndex:"status",key:"status",width:100,render:e=>{const s={0:{color:"red",text:"Êú™ËØª"},1:{color:"green",text:"Â∑≤ËØª"},2:{color:"default",text:"Â∑≤Âà†Èô§"}}[e]||{color:"default",text:"Êú™Áü•"};return t.jsx(O,{color:s.color,children:s.text})}},{title:t.jsxs("div",{className:"flex items-center gap-2 text-cyan-400 font-bold",children:[t.jsx(z,{className:"text-lg"}),t.jsx("span",{children:"ÂèëÈÄÅËÄÖ"})]}),dataIndex:"senderName",key:"senderName",width:120,render:e=>t.jsx("span",{className:"text-slate-300",children:e||"Á≥ªÁªü"})},{title:t.jsxs("div",{className:"flex items-center gap-2 text-pink-400 font-bold",children:[t.jsx(E,{className:"text-lg"}),t.jsx("span",{children:"ÂàõÂª∫Êó∂Èó¥"})]}),dataIndex:"createTime",key:"createTime",width:180,render:e=>t.jsx("span",{className:"text-slate-400 text-sm",children:a(e).format("YYYY-MM-DD HH:mm:ss")})},{title:t.jsx("div",{className:"flex items-center gap-2 text-red-400 font-bold",children:t.jsx("span",{children:"Êìç‰Ωú"})}),key:"action",width:120,render:(e,s)=>t.jsx(I,{children:t.jsx(v,{title:"Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°Ê∂àÊÅØÂêóÔºü",onConfirm:()=>J(_,s.id),okText:"Á°ÆÂÆö",cancelText:"ÂèñÊ∂à",children:t.jsx(r,{type:"text",size:"small",icon:t.jsx(N,{}),className:"text-red-400 hover:text-red-300 hover:bg-red-400/10",children:"Âà†Èô§"})})})}];return s.useEffect(()=>{U()},[]),t.jsxs(o,{children:[t.jsx(c,{icon:t.jsx(L,{}),title:"Á´ôÂÜÖ‰ø°ÁÆ°ÁêÜ",subtitle:"ÁÆ°ÁêÜ‰øÆ‰ªôÁïåÈÅìÂèãÁöÑÁ´ôÂÜÖ‰ø°Á≥ªÁªü",actions:t.jsxs("div",{className:"flex gap-2",children:[t.jsx(r,{type:"primary",icon:t.jsx(g,{}),onClick:()=>B(!0),className:"bg-gradient-to-r from-purple-500 to-pink-500 border-0 hover:from-purple-600 hover:to-pink-600",children:"ÂèëÈÄÅÊ∂àÊÅØ"}),t.jsx(r,{danger:!0,icon:t.jsx(f,{}),onClick:async()=>{try{const t=await e({url:"/message-stats",method:"POST"});T.success(`Ê∏ÖÁêÜÊàêÂäüÔºåÂÖ±Ê∏ÖÁêÜ ${t.data.cleanedCount} Êù°ËøáÊúüÊ∂àÊÅØ`),U()}catch(t){T.error("Ê∏ÖÁêÜÂ§±Ë¥•")}},className:"hover:bg-red-600",children:"Ê∏ÖÁêÜËøáÊúü"}),t.jsx(p,{loading:D,onClick:()=>{U(),_&&V(_,H.current,H.pageSize)}})]})}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[t.jsx(n,{title:"ÊÄªÊ∂àÊÅØÊï∞",value:((null==R?void 0:R.total)||0).toLocaleString(),icon:t.jsx(L,{}),gradient:"blue"}),t.jsx(n,{title:"Êú™ËØªÊ∂àÊÅØ",value:((null==R?void 0:R.unread)||0).toLocaleString(),icon:t.jsx(b,{}),gradient:"red"}),t.jsx(n,{title:"Â∑≤ËØªÊ∂àÊÅØ",value:((null==R?void 0:R.read)||0).toLocaleString(),icon:t.jsx(y,{}),gradient:"green"}),t.jsx(n,{title:"Â∑≤Âà†Èô§Ê∂àÊÅØ",value:((null==R?void 0:R.deleted)||0).toLocaleString(),icon:t.jsx(N,{}),gradient:"purple"})]}),t.jsxs("div",{className:"bg-gradient-to-br from-slate-800/50 to-slate-900/50 backdrop-blur-xl border border-slate-700/50 rounded-2xl p-6 shadow-lg",children:[t.jsxs("h3",{className:"text-xl font-bold text-white mb-4 flex items-center gap-2",children:[t.jsx(w,{className:"text-blue-400"}),"Êü•ÁúãÁî®Êà∑Ê∂àÊÅØ"]}),t.jsxs("div",{className:"flex gap-4 items-center",children:[t.jsx(l,{placeholder:"ËæìÂÖ•Áî®Êà∑IDÊü•ÁúãÊ∂àÊÅØ...",value:_,onChange:e=>G(e.target.value),className:"xiuxian-input flex-1",onPressEnter:()=>V(_)}),t.jsx(r,{type:"primary",icon:t.jsx(w,{}),onClick:()=>V(_),disabled:!_,className:"bg-gradient-to-r from-blue-500 to-cyan-500 border-0 hover:from-blue-600 hover:to-cyan-600",children:"Êü•ÁúãÊ∂àÊÅØ"})]})]}),t.jsx(x,{title:"Ê∂àÊÅØÂàóË°®",icon:t.jsx(L,{}),children:_?0===(null==d?void 0:d.messages.length)?t.jsx(u,{icon:"üì≠",title:"ÊöÇÊó†Ê∂àÊÅØ",description:"ËØ•Áî®Êà∑ÁõÆÂâçÊ≤°Êúâ‰ªª‰ΩïÊ∂àÊÅØËÆ∞ÂΩï"}):t.jsx(h,{columns:Q,dataSource:(null==d?void 0:d.messages)||[],rowKey:"id",loading:D,pagination:{current:H.current,pageSize:H.pageSize,total:H.total,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,t)=>`Á¨¨ ${t[0]}-${t[1]} Êù°ÔºåÂÖ± ${e} Êù°`},onPaginationChange:(e,t)=>{V(_,e,t||10)},rowClassName:()=>"hover:bg-gradient-to-r hover:from-purple-500/10 hover:to-blue-500/10 transition-all duration-300 bg-slate-700 hover:bg-slate-600"}):t.jsx(u,{icon:"üìù",title:"ËØ∑ÂÖàËæìÂÖ•Áî®Êà∑ID",description:"Âú®‰∏äÊñπËæìÂÖ•Ê°Ü‰∏≠ËæìÂÖ•Áî®Êà∑IDÊù•Êü•ÁúãËØ•Áî®Êà∑ÁöÑÊ∂àÊÅØÂàóË°®"})})]}),t.jsx(S,{title:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx($,{className:"text-purple-400"}),t.jsx("span",{className:"text-white",children:"ÂèëÈÄÅÁ´ôÂÜÖ‰ø°"})]}),open:q,onCancel:()=>B(!1),footer:null,className:"xiuxian-modal",width:600,children:t.jsxs(j,{form:F,layout:"vertical",onFinish:async t=>{try{const s={title:t.title,content:t.content,type:t.type,priority:t.priority||2,receivers:t.receivers?t.receivers.split(",").map(e=>e.trim()):[],expireTime:t.expireTime?new Date(t.expireTime).getTime():void 0};await(t=>e({url:"/messages",method:"POST",data:t}))(s),T.success("Ê∂àÊÅØÂèëÈÄÅÊàêÂäü"),B(!1),F.resetFields(),U()}catch(s){T.error("ÂèëÈÄÅÊ∂àÊÅØÂ§±Ë¥•")}},initialValues:{type:"system",priority:2},className:"mt-4",children:[t.jsx(j.Item,{name:"title",label:t.jsx("span",{className:"text-slate-300",children:"Ê∂àÊÅØÊ†áÈ¢ò"}),rules:[{required:!0,message:"ËØ∑ËæìÂÖ•Ê∂àÊÅØÊ†áÈ¢ò"}],children:t.jsx(l,{placeholder:"ËØ∑ËæìÂÖ•Ê∂àÊÅØÊ†áÈ¢ò",className:"xiuxian-input"})}),t.jsx(j.Item,{name:"content",label:t.jsx("span",{className:"text-slate-300",children:"Ê∂àÊÅØÂÜÖÂÆπ"}),rules:[{required:!0,message:"ËØ∑ËæìÂÖ•Ê∂àÊÅØÂÜÖÂÆπ"}],children:t.jsx(A,{rows:4,placeholder:"ËØ∑ËæìÂÖ•Ê∂àÊÅØÂÜÖÂÆπ",className:"xiuxian-input"})}),t.jsxs(k,{gutter:16,children:[t.jsx(C,{span:12,children:t.jsx(j.Item,{name:"type",label:t.jsx("span",{className:"text-slate-300",children:"Ê∂àÊÅØÁ±ªÂûã"}),rules:[{required:!0,message:"ËØ∑ÈÄâÊã©Ê∂àÊÅØÁ±ªÂûã"}],children:t.jsxs(i,{placeholder:"ËØ∑ÈÄâÊã©Ê∂àÊÅØÁ±ªÂûã",className:"xiuxian-select",children:[t.jsx(Y,{value:"system",children:"Á≥ªÁªüÊ∂àÊÅØ"}),t.jsx(Y,{value:"announcement",children:"ÂÖ¨Âëä"}),t.jsx(Y,{value:"reward",children:"Â•ñÂä±ÈÄöÁü•"}),t.jsx(Y,{value:"activity",children:"Ê¥ªÂä®ÈÄöÁü•"}),t.jsx(Y,{value:"personal",children:"‰∏™‰∫∫Ê∂àÊÅØ"})]})})}),t.jsx(C,{span:12,children:t.jsx(j.Item,{name:"priority",label:t.jsx("span",{className:"text-slate-300",children:"‰ºòÂÖàÁ∫ß"}),rules:[{required:!0,message:"ËØ∑ÈÄâÊã©‰ºòÂÖàÁ∫ß"}],children:t.jsxs(i,{placeholder:"ËØ∑ÈÄâÊã©‰ºòÂÖàÁ∫ß",className:"xiuxian-select",children:[t.jsx(Y,{value:1,children:"‰Ωé"}),t.jsx(Y,{value:2,children:"ÊôÆÈÄö"}),t.jsx(Y,{value:3,children:"È´ò"}),t.jsx(Y,{value:4,children:"Á¥ßÊÄ•"})]})})})]}),t.jsx(j.Item,{name:"receivers",label:t.jsx("span",{className:"text-slate-300",children:"Êé•Êî∂ËÄÖID"}),extra:t.jsx("span",{className:"text-slate-500",children:"Â§ö‰∏™Áî®Êà∑IDÁî®ÈÄóÂè∑ÂàÜÈöîÔºåÁïôÁ©∫Ë°®Á§∫ÂÖ®ÊúçÂèëÈÄÅ"}),children:t.jsx(l,{placeholder:"‰æãÂ¶Ç: 123456,789012",className:"xiuxian-input"})}),t.jsx(j.Item,{name:"expireTime",label:t.jsx("span",{className:"text-slate-300",children:"ËøáÊúüÊó∂Èó¥"}),extra:t.jsx("span",{className:"text-slate-500",children:"ÂèØÈÄâÔºåÁïôÁ©∫Ë°®Á§∫Ê∞∏‰∏çËøáÊúü"}),children:t.jsx(l,{type:"datetime-local",className:"xiuxian-input"})}),t.jsx(j.Item,{children:t.jsxs(I,{children:[t.jsx(r,{type:"primary",htmlType:"submit",icon:t.jsx($,{}),className:"bg-gradient-to-r from-purple-500 to-pink-500 border-0 hover:from-purple-600 hover:to-pink-600",children:"ÂèëÈÄÅ"}),t.jsx(r,{onClick:()=>B(!1),className:"bg-slate-700 hover:bg-slate-600 border-slate-600",children:"ÂèñÊ∂à"})]})})]})})]})};export{_ as default};
